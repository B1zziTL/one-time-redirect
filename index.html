<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>One-Time Redirect</title>
</head>
<body>
  <p id="message">Preparing your secure link...</p>
  <p id="output" style="word-break: break-all;"></p>

  <script>
  document.getElementById("message").textContent = "Checking access...";

  fetch("/.netlify/functions/generate")
    .then((res) => res.json())
    .then((data) => {
      if (data.url) {
        window.location.href = data.url;
      } else {
        document.getElementById("message").textContent = data.error || "Access denied.";
      }
    })
    .catch((err) => {
      document.getElementById("message").textContent = "Server error.";
      console.error(err);
    });
</script>

</body>
</html>
